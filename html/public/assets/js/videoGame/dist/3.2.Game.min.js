var regaloNavidad=regaloNavidad||{},vidas=5,puntaje=0,tiempo=0,saltando=!1,ableToSaltar1=!0,ableToSaltar2=!0,onGround=!1,touchEventDown=!1,touchEventUp=!0,HUDGame,playerAfectable=!0,inmuneActive=!1,timerInmune=0,corriendoSobreObjeto=!1;regaloNavidad.Game=function(){},regaloNavidad.Game.prototype={preload:function(){this.game.time.advancedTiming=!0},create:function(){this.game.world.setBounds(0,0,8e3,this.game.height),this.baseBackground=this.game.add.sprite(0,0,"backgroundBase"),this.baseBackground.body=null,this.baseBackground.fixedToCamera=!0,this.bgWorld=this.game.add.tileSprite(0,0,4096,640,"backgroundTiles"),this.bgWorld2=this.game.add.tileSprite(4096,0,4096,640,"backgroundTiles"),this.bgWorld.body=null,this.bgWorld2.body=null,this.game.input.mouse.enabled=!0,this.spaceBar=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.game.input.touch.touchStartCallback=this.onTouchDown,this.game.input.touch.touchEndCallback=this.onTouchUp,this.generateBuilds(),this.generateObjects(),this.player=this.game.add.sprite(100,400,"player"),this.player.animations.add("run"),HUDGame=this.game.add.group(),this.hud_top=this.game.add.sprite(0,0,"hud_top"),HUDGame.add(this.hud_top),this.hud_mitocondria=this.game.add.sprite(this.game.width-45,this.game.height-35,"hud_mitocondria"),this.hud_mitocondria.alpha=.6,HUDGame.add(this.hud_mitocondria),this.hud_enemigos=this.game.add.sprite(0,400,"hud_enemigos"),this.hud_enemigos.animations.add("running"),this.hud_enemigos.animations.play("running",15,!0),HUDGame.add(this.hud_enemigos),this.hud_Life01=this.game.add.sprite(10,this.game.height-70,"life_001"),this.hud_Life01.frame=3,HUDGame.add(this.hud_Life01),HUDGame.body=null,HUDGame.fixedToCamera=!0,this.ground=this.game.add.sprite(0,585),this.ground.scale.x=this.game.world.width,this.game.physics.enable([this.player,this.ground,this.objects],Phaser.Physics.ARCADE),this.player.body.gravity.y=1800,this.player.body.setSize(this.player.width-30,this.player.height),this.ground.body.immovable=!0,this.ground.body.allowGravity=!1,this.player.animations.play("run",15,!0),this.ordenWorld(),this.game.input.addPointer(),this.game.input.addPointer(),this.game.input.addPointer(),this.game.input.addPointer(),this.game.time.events.loop(Phaser.Timer.SECOND,this.updateTime,this),this.game.time.events.loop(.4*Phaser.Timer.SECOND,this.updateInmune,this)},update:function(){this.game.physics.arcade.collide(this.player,this.ground,this.playerOnGround,null,this),inmuneActive||this.game.physics.arcade.collide(this.player,this.objects,this.playerHit,null,this),this.player.alive&&!this.stopped&&(!this.wrapping&&this.player.x<this.game.width?(this.wrapping=!0,this.wraps++,this.builds.destroy(),this.generateBuilds(),this.generateObjects(),this.ordenWorld()):this.player.x>=this.game.width&&(this.wrapping=!1),this.spaceBar.isDown&&ableToSaltar1&&this.playerJump(),touchEventDown&&ableToSaltar2&&this.playerJump(),!this.spaceBar.isUp||onGround||this.player.body.touching.down||(ableToSaltar1=!1),!touchEventUp||onGround||this.player.body.touching.down||(ableToSaltar2=!1),inmuneActive?(this.player.body.velocity.x=300,playerAfectable=!1,timerInmune>1&&(playerAfectable=!0,inmuneActive=!1,this.player.loadTexture("player",0),this.player.animations.add("run"),this.player.animations.play("run",15,!0))):this.player.body.velocity.x=500,this.game.world.wrap(this.player,-(this.game.width/2)-190,!1,!0,!1),this.game.camera.x=this.player.x-320)},actualizarEstados:function(e){switch(e){case"vida":vidas>0&&vidas--,vidas>1?this.hud_Life01.frame=vidas-2:(this.hud_Life01.loadTexture("life_002",0),this.hud_Life01.animations.add("limitLife"),this.hud_Life01.animations.play("limitLife",15,!0)),this.game.add.tween(this.hud_enemigos).to({x:"+50"},2e3,Phaser.Easing.Linear.None,!0)}},generateObjects:function(){this.objects=this.game.add.group(),this.objects.enableBody=!0;for(var e,t=this.game.rnd.integerInRange(5,10),i=0;t>i;i++)switch(e=this.game.rnd.integerInRange(1,7)){case 1:this.tryNotOverlap(485,e,t);break;case 2:this.tryNotOverlap(540,e,t);break;case 3:this.tryNotOverlap(500,e,t);break;case 4:this.tryNotOverlap(493,e,t);break;case 5:this.tryNotOverlap(450,e,t);break;case 6:this.tryNotOverlap(470,e,t);break;case 7:this.tryNotOverlap(465,e,t)}},tryNotOverlap:function(e,t,i){var a=this.game.rnd.integerInRange(this.game.width+300,this.game.world.width-this.game.width-900);enemy=this.objects.create(a,e,"obj_0"+t);var o=this.objects.children.length;if(i==o)for(var s=0,r=0;o>r;r++){s=0;for(var n=0;o>n;n++)if(n!=r)for(;this.game.physics.arcade.overlap(this.objects.children[r],this.objects.children[n])&&!(s>3);)a=this.game.rnd.integerInRange(this.game.width+300,this.game.world.width-this.game.width-900),s++,this.objects.children[r].body.x=a}enemy.body.immovable=!0,enemy.body.allowGravity=!1},generateBuilds:function(){this.builds=this.game.add.group(),this.builds.body=null;for(var e,t=this.game.rnd.integerInRange(1,7),i=1,a=1;i>=a;a++){var o=this.game.rnd.integerInRange(this.game.width+300,this.game.world.width-this.game.width-900);e=this.builds.create(o,0,"build_0"+t)}},onTouchDown:function(e){touchEventDown=!0,touchEventUp=!1},onTouchUp:function(e){touchEventDown=!1,touchEventUp=!0},playerJump:function(){inmuneActive||(this.player.body.y>400?this.player.body.velocity.y=-400:this.player.body.y<330&&!corriendoSobreObjeto?(this.player.body.velocity.y=-400,ableToSaltar1=!1,ableToSaltar2=!1):this.player.body.y<330&&corriendoSobreObjeto?(this.player.body.velocity.y=-500,ableToSaltar1=!1,ableToSaltar2=!1):this.player.body.velocity.y=-450,saltando||(this.player.loadTexture("player_jump",0),this.player.animations.add("jump"),this.player.animations.play("jump",15,!1)),saltando=!0,onGround=!1,corriendoSobreObjeto=!1)},ordenWorld:function(){this.game.world.bringToTop(this.baseBackground),this.game.world.bringToTop(this.bgWorld),this.game.world.bringToTop(this.bgWorld2),this.game.world.bringToTop(this.ground),this.game.world.bringToTop(this.builds),this.game.world.bringToTop(this.objects),this.game.world.bringToTop(this.player),this.game.world.bringToTop(HUDGame)},updateInmune:function(){timerInmune++},updateTime:function(){tiempo++},playerOnGround:function(){onGround||inmuneActive||(onGround=!0,this.player.loadTexture("player",0),this.player.animations.add("run"),this.player.animations.play("run",15,!0)),ableToSaltar1=!0,ableToSaltar2=!0,saltando=!1,corriendoSobreObjeto=!1},playerHit:function(){playerAfectable&&this.player.body.touching.right&&(inmuneActive=!0,timerInmune=0,this.damageToPlayer()),onGround||!this.player.body.touching.down||corriendoSobreObjeto||(corriendoSobreObjeto=!0,ableToSaltar1=!0,ableToSaltar2=!0,onGround=!1,saltando=!1,this.player.loadTexture("player",0),this.player.animations.add("run"),this.player.animations.play("run",15,!0))},damageToPlayer:function(){this.player.loadTexture("player_dmg",0),this.player.animations.add("dmg"),this.player.animations.play("dmg",15,!0),this.actualizarEstados("vida")},render:function(){this.game.debug.inputInfo(32,38),this.game.debug.text(this.game.time.fps||"--",890,50,"#FFF","40px Courier"),this.game.debug.text("jump:"+saltando,32,20)}};